# ============================================================
# üìò –ü–†–û–ì–†–ê–ú–ú–ê: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—å—è–º –í–∏–∫–∏–ø–µ–¥–∏–∏ –≤ –ö–æ–Ω—Å–æ–ª–∏.
# üìå –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: Selenium + Firefox + GeckoDriver (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞)
# üß† –ê–≤—Ç–æ—Ä: N-888
# ============================================================

"""
üß† –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
1. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–µ–º—É –¥–ª—è –ø–æ–∏—Å–∫–∞ (–∏–ª–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞).
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç–∞—Ç—å—é –∏–∑ –í–∏–∫–∏–ø–µ–¥–∏–∏.
3. –ü–æ–∑–≤–æ–ª—è–µ—Ç:
    ‚Äî üìú –õ–∏—Å—Ç–∞—Ç—å –ø–∞—Ä–∞–≥—Ä–∞—Ñ—ã —Ç–µ–∫—É—â–µ–π —Å—Ç–∞—Ç—å–∏;
    ‚Äî üé≤ –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–ª—É—á–∞–π–Ω—É—é —Å–≤—è–∑–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É;
    ‚Äî üìö –í—ã–±—Ä–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—É—é —Å—Ç–∞—Ç—å—é —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏–∑ —Å–ø–∏—Å–∫–∞ 10;
    ‚Äî üß† –í–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞;
    ‚Äî üö™ –í—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
‚öôÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç GeckoDriver, –µ—Å–ª–∏ –æ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
üíæ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å –≤ —Ñ–∞–π–ª last_query.txt –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –Ω–µ–≥–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ.
"""

# --- –ò–º–ø–æ—Ä—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏ —Å–µ—Ç–µ–≤—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ ---
import time               # –î–ª—è –∑–∞–¥–µ—Ä–∂–µ–∫ (–∏–º–∏—Ç–∞—Ü–∏—è ¬´—á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ¬ª –ø–æ–≤–µ–¥–µ–Ω–∏—è)
import random             # –î–ª—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ —Å—Å—ã–ª–æ–∫
import platform           # –ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã (win32 –∏–ª–∏ win64)
import urllib.request     # –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ GeckoDriver –≤—Ä—É—á–Ω—É—é, –µ—Å–ª–∏ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
import zipfile            # –î–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ zip-–∞—Ä—Ö–∏–≤–∞
import os                 # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—É—Ç—è–º–∏ –∏ —Ñ–∞–π–ª–∞–º–∏
import subprocess          # –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å

# --- –ò–º–ø–æ—Ä—Ç Selenium –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ GeckoDriver ---
from selenium import webdriver
from selenium.webdriver.common.by import By  # –î–ª—è –ø–æ–∏—Å–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
import geckodriver_autoinstaller             # –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ GeckoDriver


# ==========================================================
# üîß –§–£–ù–ö–¶–ò–Ø 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GeckoDriver + –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Firefox
# ==========================================================
def setup_geckodriver():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ GeckoDriver, —Å–≤–µ—Ä—è–µ—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π –Ω–∞ GitHub –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏"""
    import re
    import json

    try:
        print("üîç –ü—Ä–æ–≤–µ—Ä—è—é –Ω–∞–ª–∏—á–∏–µ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å GeckoDriver...")

        # 1Ô∏è‚É£ –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é GeckoDriver —Å GitHub API
        github_api = "https://api.github.com/repos/mozilla/geckodriver/releases/latest"
        with urllib.request.urlopen(github_api, timeout=10) as response:
            data = json.load(response)
            latest_version = data["tag_name"].replace("v", "").strip()

        # 2Ô∏è‚É£ –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é Firefox
        try:
            result = subprocess.run(["firefox", "--version"], capture_output=True, text=True)
            firefox_version = re_

